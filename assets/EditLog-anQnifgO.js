import{b as N,r as i,j as e,f as p,M as o,A as u}from"./index-Dgw4cujx.js";function E(){const l=N().state.log,[s,c]=i.useState({log_date:l.log_date,licence_number:l.licence_number,id:l.id,notes:l.notes,order_num:l.order_num,qty:l.qty,repair_cost:l.repair_cost,repair_desc_ar:l.repair_desc_ar,repair_desc_en:l.repair_desc_en,term_num:l.term_num,total_cost:l.total_cost,unit:l.unit,unit_cost:l.unit_cost,vehicle_code:l.vehicle_code,vehicle_model_en:l.vehicle_model_en,vehicle_type_ar:l.vehicle_type_ar}),[j,f]=i.useState([]),[d,v]=i.useState(l.vehicle_code),[g,b]=i.useState([]),[h,y]=i.useState(l.repair_desc_ar),[m,x]=i.useState(!1);return i.useEffect(()=>{async function r(){try{const t=await fetch(`${u}/vehicles/vcode/all`);if(t.ok){const a=await t.json();f(a)}}catch{console.error("Error getting vehicle codes.")}}r()},[]),i.useEffect(()=>{async function r(){try{const t=await fetch(`${u}/vehicles/vcode/${d}`);if(t.ok){const a=await t.json();c(n=>({...n,vehicle_code:a.vehicle_code,licence_number:a.licence_number,vehicle_model_en:a.vehicle_model_en,vehicle_type_ar:a.vehicle_type_ar}))}}catch{console.error("Error getting vehicle data for",d)}}r()},[d]),i.useEffect(()=>{async function r(){try{const t=await fetch(`${u}/terms/name/all`);if(t.ok){const a=await t.json();b(a)}}catch{console.error("Error")}}r()},[]),i.useEffect(()=>{async function r(){try{const t=await fetch(`${u}/terms/name?search=${h}`);if(t.ok){const a=await t.json();c(n=>({...n,repair_desc_ar:a.repair_desc_ar,repair_desc_en:a.repair_desc_en,term_num:a.term_num}))}}catch{console.error("Error")}}h!==""&&r()},[h]),i.useEffect(()=>{function r(){const t=s.unit_cost,a=s.repair_cost,n=s.qty;t&&a&&n&&(n&&+n>1&&c(_=>({..._,total_cost:n*+t+ +a})),n&&+n==1&&c(_=>({..._,total_cost:+a+ +t})))}r()},[s.unit_cost,s.repair_cost,s.qty]),e.jsxs("div",{className:"p-10",children:[e.jsx("form",{className:"rounded-xl border border-neutral-300 bg-neutral-100 p-10 **:disabled:opacity-25 [&_input]:max-w-fit [&_input]:md:max-w-[400px] [&_input,button,textarea,select]:rounded [&_input,button,textarea,select]:p-1 [&_input,button,textarea,select]:focus:outline-0 [&_input,textarea,select]:bg-neutral-300",children:e.jsxs("div",{className:"flex flex-wrap items-start gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"date-wrapper flex flex-col gap-2",children:[e.jsx("label",{children:"التاريخ"}),e.jsx("input",{type:"date",className:`real-date ${m?"show":"hide"}`,value:s.log_date??"",onChange:r=>{c(t=>({...t,log_date:r.target.value})),x(!1)},onBlur:()=>x(!1)}),!m&&e.jsx("input",{type:"text",className:"fake-date",readOnly:!0,value:p(s.log_date??""),onClick:()=>x(!0)})]}),e.jsx("label",{children:"كود المركبة"}),e.jsx(o,{value:d,onChange:v,children:e.jsxs("div",{className:"relative md:max-w-[500px]",children:[e.jsx(o.Button,{className:"w-full rounded bg-neutral-300 p-1 text-right focus:outline-0 disabled:opacity-25",children:d||"-- اختر --"}),e.jsx(o.Options,{className:"absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded bg-white text-right shadow-lg",children:j.map((r,t)=>e.jsx(o.Option,{value:r,className:({active:a,selected:n})=>`cursor-pointer px-2 py-1 ${a?"bg-neutral-200":""} ${n?"font-bold":""} `,children:r},t))})]})}),e.jsx("label",{children:"اسم البند"}),e.jsx(o,{value:h,onChange:y,children:e.jsxs("div",{className:"relative min-w-[300px] md:max-w-[500px]",children:[e.jsx(o.Button,{className:"w-full rounded bg-neutral-300 p-1 text-right focus:outline-0 disabled:opacity-25",children:h||"-- اختر --"}),e.jsx(o.Options,{className:"absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded bg-white text-right shadow-lg",children:g.map((r,t)=>e.jsx(o.Option,{value:r,className:({active:a,selected:n})=>`cursor-pointer px-2 py-1 ${a?"bg-neutral-200":""} ${n?"font-bold":""} `,children:r},t))})]})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{children:"الوحدة"}),e.jsxs("select",{value:s.unit??"",onChange:r=>{c(t=>({...t,unit:r.target.value}))},children:[e.jsx("option",{value:"لتر",children:"لتر"}),e.jsx("option",{value:"كغم",children:"كغم"}),e.jsx("option",{value:"عدد",children:"عدد"}),e.jsx("option",{value:"أخرى",children:"أخرى"})]}),e.jsx("label",{children:"كمية التوريد"}),e.jsx("input",{dir:"ltr",type:"number",value:s.qty?s.qty:"",onChange:r=>{c(t=>({...t,qty:+r.target.value}))}}),e.jsx("label",{children:"تكلفة الوحدة"}),e.jsx("input",{type:"number",dir:"ltr",value:s.unit_cost?s.unit_cost:"",onChange:r=>{c(t=>({...t,unit_cost:+r.target.value}))}})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{children:"رقم الطلب"}),e.jsx("input",{value:s.order_num??"",onChange:r=>c(t=>({...t,order_num:r.target.value}))}),e.jsx("label",{children:"تكلفة الصيانة"}),e.jsx("input",{dir:"ltr",value:s.repair_cost?s.repair_cost:"",type:"number",onChange:r=>{c(t=>({...t,repair_cost:r.target.value===""?null:Number(r.target.value)}))}}),e.jsx("label",{children:"ملاحظات"}),e.jsx("textarea",{value:s.notes??"",className:"resize-none",onChange:r=>c(t=>({...t,notes:r.target.value}))})]})]})}),e.jsxs("div",{className:"preview mt-10",children:[e.jsx("h1",{className:"mb-3 text-xl font-bold",children:"البيانات:"}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{className:"[&_th]:font-bold",children:[e.jsx("th",{children:"التاريخ"}),e.jsx("th",{children:"رقم الطلب"}),e.jsx("th",{children:"كود المركبة"}),e.jsx("th",{children:"نوع المركبة"}),e.jsx("th",{children:"رقم اللوحة"}),e.jsx("th",{children:"سنة الإنتاج"}),e.jsx("th",{children:"كود الصيانة"}),e.jsx("th",{children:"البند"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"البيان"}),e.jsx("th",{children:"الوحدة"}),e.jsx("th",{children:"كمية التوريد"}),e.jsx("th",{children:"تكلفة الوحدة"}),e.jsx("th",{children:"تكلفة الصيانة"}),e.jsx("th",{children:"إجمالي المبلغ"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:p(s.log_date??"")}),e.jsx("td",{children:s.order_num}),e.jsx("td",{children:d}),e.jsx("td",{children:s.vehicle_type_ar??""}),e.jsx("td",{children:s.licence_number??""}),e.jsx("td",{dir:"ltr",children:s.vehicle_model_en??""}),e.jsx("td",{children:s.term_num??""}),e.jsx("td",{children:s.repair_desc_ar??""}),e.jsx("td",{dir:"ltr",children:s.repair_desc_en??""}),e.jsx("td",{dir:"ltr",children:`${s.term_num} ${s.repair_desc_ar}`}),e.jsx("td",{children:s.unit}),e.jsx("td",{children:s.qty}),e.jsx("td",{children:s.unit_cost}),e.jsx("td",{children:s.repair_cost}),e.jsx("td",{children:s.total_cost})]})})]})]})]})}export{E as default};
