import{r as s,u as X,j as e,L as q,E as G,d as H,F as a,N as J,e as K,D as O,A as g,g as Q}from"./index-DmrK3OXr.js";function W(){const[x,y]=s.useState(null),[o,h]=s.useState(null),[w,v]=s.useState(!1),[A,F]=s.useState(!0),[k,i]=s.useState(),[j,c]=s.useState("vehicle_code"),[u,S]=s.useState(""),[m,C]=s.useState(new Set),[E,N]=s.useState(new Set),[V,D]=s.useState(new Set),[_,L]=s.useState(new Set),[P,T]=s.useState(new Set),[B,M]=s.useState(new Set),[p,$]=s.useState(new Set),[f,z]=s.useState(new Set),[R,n]=s.useState(!1),{language:b}=X();function I(t){h(d=>d?d.filter(l=>l.id!==t):null)}if(s.useEffect(()=>{async function t(){try{const d=await fetch(g+"/vehicles");if(d.ok){const l=await d.json();h(l),y(l),C(new Set(l.map(r=>r.vehicle_code))),N(new Set(l.map(r=>r.vehicle_type_ar))),D(new Set(l.map(r=>r.vehicle_type_en))),L(new Set(l.map(r=>r.licence_number))),T(new Set(l.map(r=>r.vehicle_model_ar))),M(new Set(l.map(r=>r.vehicle_model_en))),$(new Set(l.map(r=>r.vehicle_dept))),z(new Set(l.map(r=>r.vehicle_state)))}}catch{v(!0)}finally{F(!1)}}t()},[]),A)return e.jsx(q,{});if(w)return e.jsx(G,{});if(o?.length===0)return e.jsx("div",{className:"flex h-[300px] items-center justify-center text-black/20",children:e.jsx(H,{size:100})});if(o&&o.length)return e.jsxs("div",{children:[e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{className:"[&_button]:absolute [&_button]:bottom-px [&_button]:left-px [&_th]:relative [&_th]:font-bold",children:[b==="english"?e.jsxs(e.Fragment,{children:[e.jsxs("th",{children:["Vehicle Code"," ",e.jsx("button",{onClick:()=>{n(!0),c("vehicle_code"),i(Array.from(m))},children:e.jsx(a,{})})]}),e.jsxs("th",{children:["Vehicle Type"," ",e.jsx("button",{onClick:()=>{n(!0),c("vehicle_type_en"),i(Array.from(V))},children:e.jsx(a,{})})]}),e.jsxs("th",{children:["Licence Number"," ",e.jsx("button",{onClick:()=>{n(!0),c("licence_number"),i(Array.from(_))},children:e.jsx(a,{})})]}),e.jsxs("th",{children:["Model"," ",e.jsx("button",{onClick:()=>{n(!0),c("vehicle_model_en"),i(Array.from(B))},children:e.jsx(a,{})})]}),e.jsxs("th",{children:["Department"," ",e.jsx("button",{onClick:()=>{n(!0),c("vehicle_dept"),i(Array.from(p))},children:e.jsx(a,{})})]}),e.jsxs("th",{children:["State"," ",e.jsx("button",{onClick:()=>{n(!0),c("vehicle_state"),i(Array.from(f))},children:e.jsx(a,{})})]}),e.jsx("th",{children:"Notes"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("th",{children:["كود المركبة"," ",e.jsx("button",{onClick:()=>{n(!0),c("vehicle_code"),i(Array.from(m))},children:e.jsx(a,{})})]}),e.jsxs("th",{children:[" ",e.jsx("button",{onClick:()=>{n(!0),c("vehicle_type_ar"),i(Array.from(E))},children:e.jsx(a,{})}),"نوع المركبة"]}),e.jsxs("th",{children:["رقم اللوحة"," ",e.jsx("button",{onClick:()=>{n(!0),c("licence_number"),i(Array.from(_))},children:e.jsx(a,{})})]}),e.jsxs("th",{children:["موديل"," ",e.jsx("button",{onClick:()=>{n(!0),c("vehicle_model_ar"),i(Array.from(P))},children:e.jsx(a,{})})]}),e.jsxs("th",{children:["القسم"," ",e.jsx("button",{onClick:()=>{n(!0),c("vehicle_dept"),i(Array.from(p))},children:e.jsx(a,{})})]}),e.jsxs("th",{children:["الحالة"," ",e.jsx("button",{onClick:()=>{n(!0),c("vehicle_state"),i(Array.from(f))},children:e.jsx(a,{})})]}),e.jsx("th",{children:"ملاحظات"})]}),e.jsx("th",{className:"hide-when-print",children:"اجراءات"})]})}),e.jsx("tbody",{children:o.map((t,d)=>e.jsxs("tr",{children:[b==="english"?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:t.vehicle_code}),e.jsx("td",{dir:"ltr",children:t.vehicle_type_en}),e.jsx("td",{children:t.licence_number}),e.jsx("td",{dir:"ltr",children:t.vehicle_model_en}),e.jsx("td",{children:t.vehicle_dept}),e.jsx("td",{className:`${t.vehicle_state==="مدمرة"?"bg-red-200":t.vehicle_state==="لا تعمل"?"bg-yellow-200":"bg-green-200"}`,children:t.vehicle_state}),e.jsx("td",{children:t.notes??""})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{children:t.vehicle_code}),e.jsx("td",{children:t.vehicle_type_ar}),e.jsx("td",{children:t.licence_number}),e.jsx("td",{children:t.vehicle_model_ar}),e.jsx("td",{children:t.vehicle_dept}),e.jsx("td",{className:`${t.vehicle_state==="مدمرة"?"bg-red-200":t.vehicle_state==="لا تعمل"?"bg-yellow-200":"bg-green-200"}`,children:t.vehicle_state}),e.jsx("td",{children:t.notes??""})]}),e.jsxs("td",{className:"hide-when-print flex gap-1 border-0 border-l p-1",children:[e.jsx(J,{to:"/edit/vehicle",className:"rounded bg-blue-500 p-2 px-3 text-white",state:{vehicle:t},children:e.jsx(K,{size:16})}),e.jsx(O,{url:`${g}/vehicles/${t.id}`,id:t.id??0,deleteEffect:I})]})]},d))})]}),R&&e.jsx(Q,{data:k??[],selectedFilterValue:u,setSelectedFilterValue:S,onExit:()=>n(!1),onFilter:t=>{if(t.preventDefault(),!x||!j||!u)return;const d=x.filter(l=>String(l[j])===String(u));h(d),n(!1),S("")},onResetFilter:()=>{n(!1),h(x)}})]})}export{W as default};
