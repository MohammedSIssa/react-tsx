import{r,u as $,j as e,L as B,E as q,F as d,N as V,d as z,D as I,A as _,e as M}from"./index-BbSKEjMI.js";function U(){const[u,f]=r.useState(null),[p,o]=r.useState(null),[m,y]=r.useState(!0),[g,b]=r.useState(!1),[w,a]=r.useState(!1),[F,l]=r.useState(),[x,c]=r.useState("term_num"),[h,j]=r.useState(""),[E,A]=r.useState(new Set),[D,T]=r.useState(new Set),[N,R]=r.useState(new Set),[k,C]=r.useState(new Set),[v,L]=r.useState(new Set),{language:S}=$();function P(t){o(n=>n?n.filter(s=>s.id!==t):null)}if(r.useEffect(()=>{async function t(){try{const n=await fetch(_+"/terms");if(n.ok){const s=await n.json();o(s),f(s),A(new Set(s.map(i=>i.term_num))),T(new Set(s.map(i=>i.repair_type_ar))),R(new Set(s.map(i=>i.repair_type_en))),C(new Set(s.map(i=>i.repair_desc_ar))),L(new Set(s.map(i=>i.repair_desc_en)))}}catch{b(!0)}finally{y(!1)}}t()},[]),m)return e.jsx(B,{});if(g)return e.jsx(q,{});if(p)return e.jsxs("div",{children:[e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{className:"[&_button]:absolute [&_button]:-top-2 [&_button]:left-0 [&_button]:cursor-pointer [&_button]:bg-white [&_th]:relative [&_th]:font-bold",children:[e.jsxs("th",{children:["#"," ",e.jsx("button",{onClick:()=>{a(!0),c("term_num"),l(Array.from(E))},children:e.jsx(d,{})})]}),S==="english"?e.jsxs(e.Fragment,{children:[e.jsxs("th",{children:["Repair Type"," ",e.jsx("button",{onClick:()=>{a(!0),c("repair_type_en"),l(Array.from(N))},children:e.jsx(d,{})})]}),e.jsxs("th",{children:["Repair Description"," ",e.jsx("button",{onClick:()=>{a(!0),c("repair_desc_en"),l(Array.from(v))},children:e.jsx(d,{})})]}),e.jsx("th",{children:"Unit"}),e.jsx("th",{children:"Quantity"}),e.jsxs("th",{dir:"ltr",children:["Cost ","($)"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("th",{children:["نوع الصيانة"," ",e.jsx("button",{onClick:()=>{a(!0),c("repair_type_ar"),l(Array.from(D))},children:e.jsx(d,{})})]}),e.jsxs("th",{children:["وصف الصيانة"," ",e.jsx("button",{onClick:()=>{a(!0),c("repair_desc_ar"),l(Array.from(k))},children:e.jsx(d,{})})]}),e.jsx("th",{children:"الوحدة"}),e.jsx("th",{children:"الكمية"}),e.jsxs("th",{children:["التكلفة ","($)"]})]}),e.jsx("th",{className:"hide-when-print",children:"اجراءات"})]})}),e.jsx("tbody",{children:p.map((t,n)=>e.jsxs("tr",{children:[S==="english"?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:t.term_num}),e.jsx("td",{children:t.repair_type_en}),e.jsx("td",{children:t.repair_desc_en}),e.jsx("td",{children:t.uom}),e.jsx("td",{children:t.qty})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{children:t.term_num}),e.jsx("td",{children:t.repair_type_ar}),e.jsx("td",{children:t.repair_desc_ar}),e.jsx("td",{children:t.uom}),e.jsx("td",{children:t.qty})]}),e.jsx("td",{children:t.service_cost}),e.jsxs("td",{className:"hide-when-print flex gap-1 border-0 border-l p-1",children:[e.jsx(V,{to:"/edit/term",className:"rounded bg-blue-500 p-2 px-3 text-white",state:{term:t},children:e.jsx(z,{size:16})}),e.jsx(I,{url:`${_}/terms/${t.id}`,id:t.id??0,deleteEffect:P})]})]},n))})]}),w&&e.jsx(M,{data:F??[],selectedFilterValue:h,setSelectedFilterValue:j,onExit:()=>a(!1),onFilter:t=>{if(t.preventDefault(),!u||!x||!h)return;const n=u.filter(s=>String(s[x])===String(h));o(n),a(!1),j("")},onResetFilter:()=>{a(!1),o(u)}})]})}export{U as default};
