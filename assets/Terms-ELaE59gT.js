import{r as s,u as U,p as G,g as H,j as e,L as J,E as K,d as O,n as W,F as X,h,N as Y,l as Z,D as ee,A as w,m as te}from"./index-CPfHk6jd.js";function re(){const[x,y]=s.useState(null),[l,u]=s.useState(null),[N,v]=s.useState(!0),[E,F]=s.useState(!1),[D,i]=s.useState(!1),[T,o]=s.useState(),[m,c]=s.useState("term_num"),[p,f]=s.useState(""),[A,P]=s.useState(new Set),[k,C]=s.useState(new Set),[R,z]=s.useState(new Set),[L,$]=s.useState(new Set),[B,q]=s.useState(new Set),{language:g}=U();function V(t){u(r=>r?r.filter(n=>n.id!==t):null)}s.useEffect(()=>{async function t(){try{const r=await fetch(w+"/terms");if(r.ok){const n=await r.json();u(n),y(n),P(new Set(n.map(a=>a.term_num))),C(new Set(n.map(a=>a.repair_type_ar))),z(new Set(n.map(a=>a.repair_type_en))),$(new Set(n.map(a=>a.repair_desc_ar))),q(new Set(n.map(a=>a.repair_desc_en)))}}catch{F(!0)}finally{v(!1)}}t()},[]);const[j,b]=s.useState(1),[d,I]=s.useState(15),[_,M]=s.useState(0),[S,Q]=s.useState(null);return s.useEffect(()=>{if(l!==null){const t=G(l,j,d),r=H(l,d);M(r),Q(t)}},[j,l,d]),s.useEffect(()=>{b(1)},[d]),N?e.jsx(J,{}):E?e.jsx(K,{}):e.jsxs("div",{children:[e.jsx("div",{className:"hide-when-print p-5 pb-2 text-2xl font-bold",children:"بنود الصيانة"}),e.jsxs("div",{className:"hide-when-print flex items-center gap-2 px-5 pb-2",children:[e.jsx(O,{onClick:()=>W(l??[])}),e.jsx("button",{className:"flex cursor-pointer items-center gap-2 rounded-lg bg-blue-500 p-2 text-white transition-all duration-200 hover:bg-blue-600",onClick:()=>window.print(),children:e.jsx(X,{size:20})})]}),e.jsxs("table",{className:"mb-25 **:text-xs",children:[e.jsx("thead",{className:"bg-slate-800 font-bold text-white",children:e.jsxs("tr",{className:"[&_button]:absolute [&_button]:top-1 [&_button]:left-1 [&_button]:cursor-pointer [&_button]:text-slate-300 [&_th]:relative [&_th]:border-r [&_th]:border-l [&_th]:border-slate-400 [&_th]:font-bold",children:[e.jsxs("th",{children:["#"," ",e.jsx("button",{onClick:()=>{i(!0),c("term_num"),o(Array.from(A))},children:e.jsx(h,{size:10})})]}),g==="english"?e.jsxs(e.Fragment,{children:[e.jsxs("th",{children:["Repair Type"," ",e.jsx("button",{onClick:()=>{i(!0),c("repair_type_en"),o(Array.from(R))},children:e.jsx(h,{size:10})})]}),e.jsxs("th",{children:["Repair Description"," ",e.jsx("button",{onClick:()=>{i(!0),c("repair_desc_en"),o(Array.from(B))},children:e.jsx(h,{size:10})})]}),e.jsx("th",{children:"Unit"}),e.jsx("th",{children:"Quantity"}),e.jsxs("th",{dir:"ltr",children:["Cost ","($)"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("th",{children:["نوع الصيانة"," ",e.jsx("button",{onClick:()=>{i(!0),c("repair_type_ar"),o(Array.from(k))},children:e.jsx(h,{size:10})})]}),e.jsxs("th",{children:["وصف الصيانة"," ",e.jsx("button",{onClick:()=>{i(!0),c("repair_desc_ar"),o(Array.from(L))},children:e.jsx(h,{size:10})})]}),e.jsx("th",{children:"الوحدة"}),e.jsx("th",{children:"الكمية"}),e.jsxs("th",{children:["التكلفة ","($)"]})]}),e.jsx("th",{className:"hide-when-print",children:"اجراءات"})]})}),e.jsx("tbody",{className:"[&_tr]:odd:bg-neutral-100 [&_tr]:even:bg-neutral-200 [&_tr]:last-of-type:bg-white",children:S&&S.map((t,r)=>e.jsxs("tr",{children:[g==="english"?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:t.term_num}),e.jsx("td",{children:t.repair_type_en}),e.jsx("td",{children:t.repair_desc_en}),e.jsx("td",{children:t.uom}),e.jsx("td",{children:t.qty})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{children:t.term_num}),e.jsx("td",{children:t.repair_type_ar}),e.jsx("td",{children:t.repair_desc_ar}),e.jsx("td",{children:t.uom}),e.jsx("td",{children:t.qty})]}),e.jsx("td",{children:t.service_cost}),e.jsxs("td",{className:"hide-when-print flex gap-1 p-1",children:[e.jsx(Y,{to:"/edit/term",className:"rounded border-0 bg-slate-700 p-2 px-3 text-white",state:{term:t},children:e.jsx(Z,{size:16})}),e.jsx(ee,{url:`${w}/terms/${t.id}`,id:t.id??0,deleteEffect:V})]})]},r))})]}),D&&e.jsx(te,{data:T??[],selectedFilterValue:p,setSelectedFilterValue:f,onExit:()=>i(!1),onFilter:t=>{if(t.preventDefault(),!x||!m||!p)return;const r=x.filter(n=>String(n[m])===String(p));u(r),i(!1),f("")},onResetFilter:()=>{i(!1),u(x)}}),e.jsxs("div",{className:"hide-when-print fixed bottom-0 mt-4 flex h-20 w-full items-center justify-between bg-slate-800 p-2 px-10",children:[e.jsx("div",{children:_>1&&Array.from({length:_}).map((t,r)=>e.jsx("button",{onClick:()=>b(r+1),className:`h-fit cursor-pointer border-r border-l border-slate-800 px-3 py-1 shadow-sm transition-colors duration-200 ${j===r+1?"bg-slate-600 font-semibold text-white":"bg-gray-100 text-gray-800"} `,children:r+1},r))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-white",children:"عدد السطور: "}),e.jsxs("select",{value:d,onChange:t=>I(Number(t.target.value)),className:"w-30 bg-slate-700 p-2 text-white focus:outline-0 [&_option]:bg-slate-700",children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:30,children:"30"}),e.jsx("option",{value:9999,children:"كل السطور"})]})]})]})]})}export{re as default};
